<svg viewBox="0 0 1500 1000" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
        </marker>
    </defs>

    <!-- Head 1 -->
    <g transform="translate(100, 100)">
        <rect x="-20" y="-40" width="1200" height="150" style="fill:none; stroke:#9e9e9e; stroke-width:2; stroke-dasharray:5 5; rx:10; ry:10;"/>
        <text x="0" y="-15" style="font-family:sans-serif; font-size:18px; font-weight:bold; fill:#333; text-anchor:start; dominant-baseline:central;">Head 1</text>
        <rect x="0" y="0" width="150" height="60" style="fill:#bbdefb; stroke:#1e88e5; stroke-width:2; rx:8; ry:8;"/>
        <text x="75" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Conv1d</text>
        <text x="75" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(in=channels, out=256)</text>
        <path d="M 150 30 L 200 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="200" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="250" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
        <path d="M 300 30 L 350 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="350" y="0" width="150" height="60" style="fill:#bbdefb; stroke:#1e88e5; stroke-width:2; rx:8; ry:8;"/>
        <text x="425" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Conv1d</text>
        <text x="425" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(in=256, out=128)</text>
        <path d="M 500 30 L 550 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="550" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="600" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
        <path d="M 650 30 L 700 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="700" y="0" width="100" height="60" style="fill:#f8bbd0; stroke:#e91e63; stroke-width:2; rx:8; ry:8;"/>
        <text x="750" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Dropout</text>
        <text x="750" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(0.2)</text>
        <path d="M 800 30 L 850 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="850" y="0" width="150" height="60" style="fill:#bbdefb; stroke:#1e88e5; stroke-width:2; rx:8; ry:8;"/>
        <text x="925" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Conv1d</text>
        <text x="925" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(in=128, out=channels)</text>
        <path d="M 1000 30 L 1050 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="1050" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="1100" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
    </g>

    <!-- Head 2 -->
    <g transform="translate(100, 300)">
        <rect x="-20" y="-40" width="1080" height="150" style="fill:none; stroke:#9e9e9e; stroke-width:2; stroke-dasharray:5 5; rx:10; ry:10;"/>
        <text x="0" y="-15" style="font-family:sans-serif; font-size:18px; font-weight:bold; fill:#333; text-anchor:start; dominant-baseline:central;">Head 2</text>
        <rect x="0" y="0" width="170" height="60" style="fill:#bbdefb; stroke:#1e88e5; stroke-width:2; rx:8; ry:8;"/>
        <text x="85" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Conv1d</text>
        <text x="85" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(input_dim, 64, k=kernel_size)</text>
        <path d="M 170 30 L 220 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="220" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="270" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
        <path d="M 320 30 L 370 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="370" y="0" width="150" height="60" style="fill:#bbdefb; stroke:#1e88e5; stroke-width:2; rx:8; ry:8;"/>
        <text x="445" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Conv1d</text>
        <text x="445" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(64, 64, k=kernel_size)</text>
        <path d="M 520 30 L 570 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="570" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="620" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
        <path d="M 670 30 L 720 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="720" y="0" width="150" height="60" style="fill:#bbdefb; stroke:#1e88e5; stroke-width:2; rx:8; ry:8;"/>
        <text x="795" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Conv1d</text>
        <text x="795" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(64, 1, k=kernel_size)</text>
        <path d="M 870 30 L 920 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="920" y="0" width="100" height="60" style="fill:#ffe0b2; stroke:#fb8c00; stroke-width:2; rx:8; ry:8;"/>
        <text x="970" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Flatten</text>
    </g>

    <!-- Q Net -->
    <g transform="translate(100, 500)">
        <rect x="-20" y="-40" width="1000" height="150" style="fill:none; stroke:#9e9e9e; stroke-width:2; stroke-dasharray:5 5; rx:10; ry:10;"/>
        <text x="0" y="-15" style="font-family:sans-serif; font-size:18px; font-weight:bold; fill:#333; text-anchor:start; dominant-baseline:central;">DQN - QNet</text>
        <rect x="0" y="0" width="180" height="60" style="fill:#e1bee7; stroke:#8e24aa; stroke-width:2; rx:8; ry:8;"/>
        <text x="90" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Linear</text>
        <text x="90" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(in=96, out=256)</text>
        <path d="M 180 30 L 230 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="230" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="280" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
        <path d="M 330 30 L 380 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="380" y="0" width="180" height="60" style="fill:#e1bee7; stroke:#8e24aa; stroke-width:2; rx:8; ry:8;"/>
        <text x="470" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Linear</text>
        <text x="470" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(in=256, out=512)</text>
        <path d="M 560 30 L 610 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="610" y="0" width="100" height="60" style="fill:#c8e6c9; stroke:#43a047; stroke-width:2; rx:8; ry:8;"/>
        <text x="660" y="30" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">ReLU</text>
        <path d="M 710 30 L 760 30" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <rect x="760" y="0" width="180" height="60" style="fill:#e1bee7; stroke:#8e24aa; stroke-width:2; rx:8; ry:8;"/>
        <text x="850" y="25" style="font-family:sans-serif; font-size:14px; fill:#333; text-anchor:middle; dominant-baseline:central;" font-weight="bold">Linear</text>
        <text x="850" y="40" style="font-family:sans-serif; font-size:12px; fill:#333; text-anchor:middle; dominant-baseline:central;">(in=512, out=Q)</text>
    </g>

    <g transform="translate(100, 650)"> 
        <text x="500" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#333">Agent Architecture Summary</text>

        <!-- Input -->
        <g transform="translate(0, 50)"> 
            <rect x="0" y="0" width="150" height="200" fill="#f0f8ff" stroke="#4682b4" stroke-width="2" rx="8"/>
            <text x="75" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Input Dict</text>
            <rect x="10" y="40" width="130" height="40" fill="#e6f3ff" stroke="#4682b4" stroke-width="1" rx="3"/>
            <text x="75" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">"original"</text>
            <text x="75" y="73" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">(N, D, T)</text>
            <rect x="10" y="90" width="130" height="40" fill="#e6f3ff" stroke="#4682b4" stroke-width="1" rx="3"/>
            <text x="75" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">"nun"</text>
            <text x="75" y="123"  text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">(N, D, T)</text>
            <rect x="10" y="140" width="130" height="40" fill="#fff0e6" stroke="#ff8c00" stroke-width="1" rx="3"/>
            <text x="75" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">"mask"</text>
            <text x="75" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">(N, D, T)</text>
        </g>

        <path d="M 140 110 L 200 110 L 200 123 L 250 123" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <path d="M 140 160 L 200 160 L 200 137 L 250 137" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>
        <path d="M 140 210 L 510 210 L 510 175" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/>

        <!-- Agent Net -->
        <g transform="translate(180, 85)"> 
            <text x="325" y="-15" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Feature Extractor</text>
            <rect x="40" y="0" width="590" height="90" style="fill:none; stroke:#9e9e9e; stroke-width:2; stroke-dasharray:5 5; rx:10; ry:10;"/>

            <rect x="70" y="20" width="150" height="50" fill="#e0e0e0" stroke="#757575" stroke-width="2" rx="8" ry="8"/>
            <text x="145" y="50" text-anchor="middle" style="font-family:sans-serif; font-size:16px; font-weight:bold;" fill="#333">Head 1</text>

            <path d="M 220 45 L 305 45" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/> 

            <g transform="translate(300, 15)">
                <circle cx="30" cy="30" r="25" fill="#e8f5e8" stroke="#4caf50" stroke-width="2"/>
                <text x="30" y="47" text-anchor="middle" font-family="Arial, sans-serif" font-size="50" font-weight="20" fill="#333">+</text>
                <text x="30" y="0" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">Concatenate</text> 
                <text x="30" y="67" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">(N, 3Ã—D, T)</text>
            </g>

            <path d="M 356 45 L 450 45" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/> 

            <rect x="450" y="20" width="150" height="50" fill="#e0e0e0" stroke="#757575" stroke-width="2" rx="8" ry="8"/>
            <text x="525" y="50" text-anchor="middle" style="font-family:sans-serif; font-size:16px; font-weight:bold;" fill="#333">Head 2</text>
            
            <path d="M 601 45 L 700 45" style="stroke:#424242; stroke-width:2;fill:none;" marker-end="url(#arrowhead)"/> 
            
            <text x="770" y="-15" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">MLP Extractor</text>
            <rect x="700" y="20" width="150" height="50" fill="#e0e0e0" stroke="#757575" stroke-width="2" rx="8" ry="8"/>
            <text x="770" y="50" text-anchor="middle" style="font-family:sans-serif; font-size:16px; font-weight:bold;" fill="#333">Decision Net</text>
        </g>
    </g>
</svg>
